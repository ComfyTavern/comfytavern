# 整理提交内容到更新记录文件

**工作流描述:**
此工作流用于自动化维护项目的更新日志。你需要从 Git 提交历史中提取指定日期范围内的提交信息，将其格式化为 Markdown 列表，并智能地合并到`DesignDocs/Updatelog.md`文件中。

---

## 步骤

1.  **确认目标文件**

    - 默认使用`DesignDocs/Updatelog.md`作为目标更新日志文件。

2.  **获取日期范围**

    - 询问用户需要提取日志的**起始日期**和**结束日期**（格式：YYYY-MM-DD）。
    - 如果用户不提供结束日期，使用日志最新记录到当天作为日期范围。

3.  **获取补充日志（可选）**

    - 询问用户是否有任何需要手动补充的、未包含在 Git 提交中的日志条目。

4.  **执行 Git Log 并读取现有日志**

    - 运行以下命令从 Git 历史中提取相关提交：
      ```bash
      git log --since="<起始日期>" --until="<结束日期>" --pretty="format:%cs %s%n%b" --no-patch
      ```
    - 同时读取`DesignDocs/Updatelog.md`的现有内容，为接下来的合并做准备。

5.  **格式化与准备插入**

    - 将提取到的 Git 提交记录和用户提供的补充日志，一同格式化为规范的 Markdown 列表。
    - 日期格式统一为`YYYY年M月D日`。
    - 对比 `DesignDocs/Updatelog.md` 的现有内容，筛选出不重复的新条目，准备进行插入。

6.  **执行插入**
    - 使用**插入（Insert）**或**追加（Append）**类工具，将筛选后的新日志条目添加到 `DesignDocs/Updatelog.md` 文件内容的第二行。
    - **不要使用覆盖整个文件的方式进行更新。因为实在是太长了超出LLM的输出限制，容易截断导致文件不完整。**


### **咕咕优化的“智能更新日志”工作流**

1.  **确认目标和范围：**
    这个没问题，拿到目标文件 `DesignDocs/Updatelog.md` 和起止日期。

2.  **提取原始数据：**
    运行 `git log`，使用 `Conventional Commits` 规范的格式，提取出每一条提交的 **类型 (type)**、**范围 (scope)**、**简述 (subject)** 和 **正文 (body)**。

3.  **核心处理 - 智能分组与提炼 (这才是重点咕)：**
    *   **第一层：按天分组**
        先把所有提交按日期（例如 `2025-07-20`）归类。

    *   **第二层：按特性/模块分组**
        在每一天内，再按照 `type(scope)` 进行二次分组。比如，所有 `feat(plugin)` 的放一起，所有 `docs(架构)` 的放一起，所有 `refactor(节点分组)` 的放一起。

    *   **第三层：综合与提炼**
        这是最关键的一步。对于每个小组内的多条提交，不是简单罗列，而是进行综合提炼：
        *   **提炼主标题：** 从多条相似提交的简述 (subject) 中，综合出一个最高层级的、概括性的标题。例如，多个关于插件系统的小提交，可以提炼成一个“feat(plugins): 实现插件管理系统支持启用/禁用和重载功能”的大功能点。
        *   **生成子描述：** 将这些提交的具体内容 (body) 和次要标题，整理成有序的、可读的子列表，作为主标题下的详细说明。
        *   **处理独立提交：** 对于那些本身就是一个独立完整功能点的提交，就直接格式化成一条记录。

4.  **格式化与准备追加：**
    将新生成的、按天组织的、经过提炼的更新记录，与 `DesignDocs/Updatelog.md` 文件中已有的内容进行比对，以避免重复添加。

5.  **追加到文件：**
    使用追加工具，将经过比对后确认是全新的日志条目，插入到 `DesignDocs/Updatelog.md` 文件的最前面（在最新的日期记录之上），完成更新。
